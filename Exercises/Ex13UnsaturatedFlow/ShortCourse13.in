TITLE
1D transport with unsaturated flow
END

RUNTIME
time_units       days
timestep_max     0.01
timestep_init    0.01
time_tolerance   10.0
ResidualTolerance   1.0E-9 
correction_max   2
debye-huckel     yes
model_spinup     yes
master           Tracer
hindmarsh        false 
database_sweep   no
speciate_only    false
gimrt            true
generate_velocity_vector True
database         datacom.dbs
screen_output    1000
END

OUTPUT
time_units               days
spatial_profile          1.0 4.0 6.5
time_series          Tracer1.out 30 1 1
time_series_units    Mol/kgw
time_series_interval 1
END

TRANSPORT
distance_units meters
time_units     seconds
fix_diffusion  1.0e-09
dispersivity   0.0
END


FLOW
time_units       days
distance_units   meters
calculate_flow  TRUE

!PERMEABILITY
permeability_x 2.95e-13 default
permeability_y 0 default
permeability_z 0 default

!RICHARD
gravity 0.0 90.0 90.0 up ! gravity is from x_begin to x_end
Richards  TRUE ! Richards solver is used to compute velocity
Richards_print FALSE ! Newton and line search results are not printed
Richards_steady FALSE ! steady-state Richards solver is not used to the initial condition for time-dependent Richards solver
read_richards_ic_file initial_condition.csv SingleColumn ! initial condition for time-dependent Richards solver
!! van Genuchten parameters
vg_theta_r 120 0.0
vg_theta_s 120 0.33
vg_alpha   120 1.43
vg_n       120 1.506
!! boundary conditions for time-dependent Richards solver
!!! flux boundary condition at x_begin
!!! Because the gravity is from x_begin to x_end, the positive value means infiltration
x_begin_bc_type constant_flux 0.2
!!! Neumann boundary condition (gradient of water potential is set to 0 here) at x_end
x_end_bc_type constant_neumann 0.0 
END

POROSITY
fix_porosity 0.33
porosity_update false
END

BOUNDARY_CONDITIONS
x_begin     injection     Dirichlet
x_end   initial   Dirichlet
END

INITIAL_CONDITIONS
initial   1-120 1-1 1-1
END

DISCRETIZATION
distance_units  meters
xzones 120 0.05
yzones 1 1
zzones 1 1
END

PRIMARY_SPECIES
Tracer
H+
Na+
Cl-
END

SECONDARY_SPECIES
OH-
END

Condition initial
units            mol/kg
temperature      30.0
Tracer         1.0E-8
H+             1.0E-8
Na+              0.01
Cl-              0.01
END

Condition injection
units            mol/kg
temperature      30.0
Tracer         1.0E-3
H+             1.0E-3
Na+              0.01
Cl-              0.01
END

TEMPERATURE
set_temperature  30.0
END

